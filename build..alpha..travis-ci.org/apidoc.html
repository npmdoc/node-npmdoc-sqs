<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/mafintosh/sqs"

    >sqs (v2.0.2)</a>
</h1>
<h4>A message queue using Amazon Simple Queue Service.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.sqs">module sqs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sqs.sqs">
            function <span class="apidocSignatureSpan"></span>sqs
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sqs.toString">
            function <span class="apidocSignatureSpan">sqs.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.sqs.toString">module sqs.toString</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.sqs.toString.toString">
            function <span class="apidocSignatureSpan">sqs.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sqs" id="apidoc.module.sqs">module sqs</a></h1>


    <h2>
        <a href="#apidoc.element.sqs.sqs" id="apidoc.element.sqs.sqs">
        function <span class="apidocSignatureSpan"></span>sqs
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sqs = function (options) {
	options = options || {};

	options.access = options.access || process.env.SQS_ACCESS_KEY || process.env.AWS_ACCESS_KEY_ID;
	options.secret = options.secret || process.env.SQS_SECRET_KEY || process.env.AWS_SECRET_ACCESS_KEY;
	options.region = options.region || process.env.SQS_REGION || process.env.AWS_REGION || DEFAULT_REGION;
	options.raw = options.raw || false;
	options.proxy = options.proxy || false;

	if (!options.access || !options.secret) throw new Error(&#x27;options.access and options.secret are required&#x27;);

	var queues = {};
	var closed = false;
	var proto = options.https ? &#x27;https://&#x27; : &#x27;http://&#x27;;

	var host = &#x27;sqs.&#x27;+options.region+&#x27;.amazonaws.com&#x27;;
	if (options.proxy) host = options.proxy;

	var namespace = options.namespace ? options.namespace+&#x27;-&#x27; : &#x27;&#x27;;

	namespace = namespace.replace(/[^a-zA-Z0-9]/g, &#x27;-&#x27;).replace(/\-+/g, &#x27;-&#x27;);

	var queryURL = function(action, path, params) {
		params = params || {};

		params.Action = action;
		params.AWSAccessKeyId = options.access;
		params.SignatureMethod = SIGNATURE_METHOD;
		params.SignatureVersion = SIGNATURE_VERSION;
		params.Expires = new Date(Date.now()+SIGNATURE_TTL).toISOString();
		params.Version = VERSION;

		var stringToSign = &#x27;GET\n&#x27;+host+&#x27;\n&#x27;+path+&#x27;\n&#x27;+Object.keys(params).sort().map(function(name) {
			return name+&#x27;=&#x27;+encodeURIComponent(params[name]).replace(/[!&#x27;()]/g, escape).replace(/\*/g, &#x27;%2A&#x27;);
		}).join(&#x27;&#x26;&#x27;);

		params.Signature = crypto.createHmac(&#x27;sha256&#x27;,options.secret).update(stringToSign).digest(&#x27;base64&#x27;);

		return proto+host+path+&#x27;?&#x27;+qs.stringify(params);
	};

	var retry = function(req, url, callback) {
		var retries = 0;
		var action = function() {
			req(url, {timeout:10000}, function(err, res) {
				if (!err &#x26;&#x26; res.statusCode &#x3e;= 500) err = new Error(&#x27;invalid status-code: &#x27;+res.statusCode);
				if (callback) return callback(err);
				if (!err) return;
				retries++;
				if (retries &#x3e; 15) return that.emit(&#x27;error&#x27;, new Error(&#x27;could not send &#x27;+url));
				setTimeout(action, retries*1000);
			});
		};

		action();
	};

	var queueURL = function(name, callback) {
		if (queues[name]) return queues[name](callback);

		var stack = [callback];

		queues[name] = function(callback) {
			stack.push(callback);
		};

		var onresult = function(err, url) {
			if (err) return that.emit(&#x27;error&#x27;, err);

			queues[name] = function(callback) {
				callback(url);
			};

			while (stack.length) {
				stack.shift()(url);
			}
		};

		request(queryURL(&#x27;CreateQueue&#x27;, &#x27;/&#x27;, {QueueName:name}), function(err) {
			if (err) return onresult(err);
			request(queryURL(&#x27;GetQueueUrl&#x27;, &#x27;/&#x27;, {QueueName:name}), function(err, res) {
				if (err || res.statusCode !== 200) {
					var errMessage = res.body ? text(res.body, &#x27;Message&#x27;) : &#x27;&#x27;;
					return onresult(err || new Error(&#x27;invalid status code from GetQueueUrl: &#x27;+res.statusCode +
							(errMessage? &#x27;. &#x27;+errMessage : &#x27;&#x27;) ));
				}
				onresult(null, &#x27;/&#x27;+text(res.body, &#x27;QueueUrl&#x27;).split(&#x27;/&#x27;).slice(3).join(&#x27;/&#x27;));
			});
		});
	};

	var that = new events.EventEmitter();

	that.push = function(name, message, callback) {
		name = namespace+name;

		queueURL(name, function(url) {
			var body = options.raw ? message : JSON.stringify(message);
			retry(request, queryURL(&#x27;SendMessage&#x27;, url, {MessageBody: body}), callback);
		});
	};

	that.delete = that.del = function(name, callback) {
		name = namespace+name;

		queueURL(name, function(url) {
			retry(request, queryURL(&#x27;DeleteQueue&#x27;, url), callback);
		});
	};

	var wait = options.wait || 2000;

	that.pull = function(name, workers, onmessage) {
		if (typeof workers === &#x27;function&#x27;) return that.pull(name, options.workers || 1, workers);

		name = namespace+name;

		var agent =  options.https ? new https.Agent({maxSockets:workers}) : new http.Agent({maxSockets:workers}); // long poll should
 use its own agent
		var req = request.defaults({agent:agent});

		range(workers).forEach(function() {
			var next = function() {
				if (closed) return;

				queueURL(name, function(url) {
					req(queryURL(&#x27;ReceiveMessage&#x27;, url, {WaitTimeSeconds:20}), function(err, res) {
						if (err || res ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.sqs.toString" id="apidoc.element.sqs.toString">
        function <span class="apidocSignatureSpan">sqs.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    return text;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.sqs.toString" id="apidoc.module.sqs.toString">module sqs.toString</a></h1>


    <h2>
        <a href="#apidoc.element.sqs.toString.toString" id="apidoc.element.sqs.toString.toString">
        function <span class="apidocSignatureSpan">sqs.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toString() { [native code] }</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
